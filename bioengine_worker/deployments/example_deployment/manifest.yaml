authors:
- {affiliation: KTH, github_user: nilsmechtel, name: Nils Mechtel}
covers: []
description: Example deployment model for BioEngine.
documentation: README.md
format_version: 0.5.0
git_repo: https://github.com/bioimage-io/bioengine
id: example-deployment
id_emoji: '⚙️'
license: MIT
links: []
maintainers: []
name: Example Deployment
tags: [deep-learning, pytorch]
type: model
deployment_class:
  python_file: main.py
  class_name: ExampleModel
  multiplexed:
    # This is a multiplexed deployment, meaning that multiple models can be loaded
    # Note: Only works for async methods; method requires exactly one argument: model_id
    method_name: _get_model
    max_num_models_per_replica: 1
  exposed_methods:
    ping: {}
    train: {}
deployment_config:
  modes:
    cpu:
      ray_actor_options:
        num_gpus: 0
        num_cpus: 1
        # memory: 4294967296  # 4GB RAM
        runtime_env:
          uv: ["torch==2.1.2"]
    gpu:
      ray_actor_options:
        num_gpus: 1
        num_cpus: 1
        # memory: 4294967296  # 4GB RAM
        runtime_env:
          uv: ["torch==2.1.2"]
  max_ongoing_requests: 1  # Needs to be 1 for GPU
  max_queued_requests: 10
  autoscaling_config:
    min_replicas: 1
    initial_replicas: 1
    max_replicas: 2
    target_num_ongoing_requests_per_replica: 0.8
    metrics_interval_s: 2.0
    look_back_period_s: 10.0
    downscale_delay_s: 300
    upscale_delay_s: 0.0
  health_check_period_s: 30.0
  health_check_timeout_s: 30.0
  graceful_shutdown_timeout_s: 300.0
  graceful_shutdown_wait_loop_s: 2.0
